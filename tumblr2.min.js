/*!
 * Tumblr2 - JavaScript SDK for Tumblr API v2
 *
 * Copyright 2011-2012, Tetsuwo OISHI.
 * Dual license under the MIT license.
 * http://tetsuwo.tumblr.com
 *
 * Date: 2011-11-07
 */

function Tumblr2(a){this.initialize.apply(this,arguments)}Tumblr2.prototype.initialize=function(a){this.apiUrl="http://api.tumblr.com/v2";this.name="_tumblr2";this.times=0;this.requests=[];this.data=[];this.debug=!1;this.win=document.defaultView||document.parentWindow;this.config={apiKey:null,baseHostname:null};if(a&&(a.debug&&(this.debug=a.debug),a.apiKey&&(this.config.apiKey=a.apiKey),a.baseHostname))this.config.baseHostname=a.baseHostname;this.output(a)};
Tumblr2.prototype.setApiKey=function(a){this.config.apiKey=a;return this};Tumblr2.prototype.setBaseHostname=function(a){this.config.baseHostname=a;return this};Tumblr2.prototype.output=function(a){this.debug&&console.log(a)};Tumblr2.prototype.serialize=function(a,c){var b=[],d;for(d in a){var f=c?c+"["+d+"]":d,e=a[d];b.push("object"==typeof e?this.serialize(e,f):encodeURIComponent(f)+"="+encodeURIComponent(e))}return b.join("&")};
Tumblr2.prototype.api=function(a,c,b){var d=this.name+"_cb_"+this.times;this.win[d]=b;c=c||{};c.apiKey=this.config.apiKey;c.jsonp=d;this.requests[this.times]={method:a,param:c,callback:b,callbackName:d};"all"===c.limit&&(c.limit=null);this.times++;b=document.createElement("script");b.type="text/javascript";b.async=!0;b.src=this.apiUrl;b.src=0===a.indexOf("/blog")?b.src+a.replace("/blog","/blog/"+this.config.baseHostname):b.src+a;b.src+="?"+this.serialize(c);this.output(b.src);a=document.getElementsByTagName("script")[0];
a.parentNode.insertBefore(b,a);return this};
